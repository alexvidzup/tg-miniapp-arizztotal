<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Content Library</title>

  <!-- Telegram SDK -->
  <script src="https://telegram.org/js/telegram-web-app.js"></script>

  <style>
    body {
      background: #0f0f0f;
      color: #ffffff;
      font-family: -apple-system, BlinkMacSystemFont, sans-serif;
      padding: 16px;
      margin: 0;
    }

    h2 {
      margin-top: 0;
    }

    button {
      width: 100%;
      padding: 14px;
      margin: 10px 0;
      font-size: 16px;
      border-radius: 10px;
      border: none;
      background: #1f1f1f;
      color: white;
      cursor: pointer;
    }

    button.secondary {
      background: #333;
    }
  </style>
</head>

<body>
  <div id="app">
    <h2>üìÇ Browse Content</h2>

    <!-- Categories -->
    <div id="categories">
      <button onclick="openCategory('party_videos')">Party Videos</button>
      <button onclick="openCategory('lay_reports')">Lay Reports </button>
	  <button onclick="openCategory('articles')">Articles </button>
    </div>

    <!-- Videos -->
    <div id="videos" style="display:none;"></div>
  </div>

  <script>
    let DATA = {};

fetch("https://opensheet.elk.sh/1K4rJtQUi4k5S6ihxogTM4ilWvTGsjeIv-2mfcMbPUP8/Sheet1")
  .then(res => res.json())
  .then(rows => {
    rows.forEach(row => {
      const category = row.Category;
      if (!DATA[category]) DATA[category] = [];

      DATA[category].push({
        title: row.Title,
        url: row.Link
      });
    });
  });

    // --- FUNCTIONS ---
    function openCategory(category) {
  const videosDiv = document.getElementById("videos");

  if (!DATA[category] || DATA[category].length === 0) {
    videosDiv.innerHTML = `
      <button class="secondary" onclick="goBack()">‚Üê Back</button>
      <h2>No content yet</h2>
    `;
  } else {
    videosDiv.innerHTML = `
      <button class="secondary" onclick="goBack()">‚Üê Back</button>
      <h2>${category.replace("_", " ").toUpperCase()}</h2>
    `;

    DATA[category].forEach(video => {
      videosDiv.innerHTML += `
        <button onclick="openVideo('${video.url}')">
          ‚ñ∂ ${video.title}
        </button>
      `;
    });
  }

  document.getElementById("categories").style.display = "none";
  videosDiv.style.display = "block";
}

    function goBack() {
      document.getElementById("videos").style.display = "none";
      document.getElementById("categories").style.display = "block";
    }

    function openVideo(url) {
      Telegram.WebApp.openTelegramLink(url);
    }

    // --- TELEGRAM INIT ---
    Telegram.WebApp.ready();
    Telegram.WebApp.expand();
  </script>
  
</body>
</html>
